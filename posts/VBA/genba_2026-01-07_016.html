<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>実務でよく使う自動化テクニック</title>
  <link rel="stylesheet" href="/assets/styles.css?v=1767406624605">
</head>
<body>
  <main class="container">
    <article class="card">
      <header>
        <h1>実務でよく使う自動化テクニック</h1>
        <nav><a href="/posts/VBA/">VBA記事一覧</a></nav>
        <p class="meta">投稿日：2026-01-07</p>
      </header>

      <section class="card" style="margin-top:12px;">
        <h2 style="margin:0 0 8px 0;">音声</h2>
        <audio controls preload="none" src="/posts/genba/audio/016.mp3"></audio>
        <p class="meta" style="margin-top:8px; opacity:0.85;">※ AI音声で読み上げます</p>
      </section>

      <section id="sec-toc">
        <h2>目次</h2>
        <ol>
  <li><a href="#sec-1">条件付き書式をVBAで設定する</a></li>
  <li><a href="#sec-2">グラフの自動作成（ChartObjectsコレクション）</a></li>
  <li><a href="#sec-3">印刷処理の自動化（PrintOut、PrintPreview）</a></li>
  <li><a href="#sec-4">ExportAsFixedFormatでPDF出力</a></li>
  <li><a href="#sec-5">Application.ScreenUpdatingで画面更新を制御する</a></li>
  <li><a href="#sec-6">注意（ここだけ）</a></li>
  <li><a href="#sec-7">要約</a></li>
</ol>
      </section>

      <section id="sec-1">
  <h3>条件付き書式をVBAで設定する</h3>
  <p>条件付き書式をVBAでルール化すると、一貫した見た目にしやすくなり、人的ミスも減らせます。</p>
<p>Range.FormatConditionsを使い、既存ルールは削除してから追加します。マクロは標準モジュールへ置き、保存は.xlsmが推奨です。</p>
<pre><code>Sub ApplySimpleCF()
  Dim rng As Range
  Set rng = ThisWorkbook.Sheets("Sheet1").Range("B2:B20")
  rng.FormatConditions.Delete
  rng.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, Formula1:="=0"
  rng.FormatConditions(1).Interior.Color = RGB(255,200,200)
  rng.FormatConditions.AddColorScale 2
End Sub
</code></pre>
<p>ポイントとして、範囲指定のミスやFormatConditionsの重複は要チェックです。Rangeはブロック操作に向き、Cellsはループ処理に向きます。</p>
</section>

<section id="sec-2">
  <h3>グラフの自動作成（ChartObjectsコレクション）</h3>
  <p>ChartObjectsコレクションでシート上にChartObjectを追加し、サイズ・位置・ソースを設定します。定期レポートで有効です。凡例や系列はSeriesCollectionで細かく調整します。</p>

<pre><code>Sub CreateSalesChart()
  Dim ws As Worksheet, ch As ChartObject
  Set ws = ThisWorkbook.Sheets("Sheet1")
  On Error Resume Next: ws.ChartObjects("SalesChart").Delete: On Error GoTo 0
  Set ch = ws.ChartObjects.Add(300,10,400,250): ch.Name = "SalesChart"
  With ch.Chart
    .ChartType = xlLineMarkers
    .SetSourceData ws.Range("A1:B13")
    .HasTitle = True: .ChartTitle.Text = "月次売上"
  End With
End Sub</code></pre>

<p>事前に印刷範囲や列幅を整えると見栄えが安定します。</p>
</section>

<section id="sec-3">
  <h3>印刷処理の自動化（PrintOut、PrintPreview）</h3>
  <p>ActiveSheet.PrintOut／PrintPreviewで印刷を自動化します。From/To/Copies/Previewなどの引数で制御できます。PageSetupで用紙サイズや向きを事前に固定すると、期待どおりの出力になりやすいです。</p>

<pre><code>Sub PrintReport()
  With ThisWorkbook.Sheets("Sheet1").PageSetup
    .Orientation = xlPortrait: .PaperSize = xlPaperA4
  End With
  ThisWorkbook.Sheets("Sheet1").PrintPreview
  ' ThisWorkbook.Sheets("Sheet1").PrintOut Copies:=1, Preview:=False
End Sub</code></pre>

<p>共有プリンタ環境では、テスト印刷を推奨します。</p>
</section>

<section id="sec-4">
  <h3>ExportAsFixedFormatでPDF出力</h3>
  <p>ExportAsFixedFormatでシートやブックをPDF化します。ファイル名に日付や時刻を付けて上書きを避け、PrintAreaを設定して不要な分割を防ぎます。</p>

<pre><code>Sub ExportSheetToPDF()
  Dim fpath As String
  fpath = ThisWorkbook.Path &amp; "\Report_" &amp; Format(Date, "yyyymmdd") &amp; ".pdf"
  ThisWorkbook.Sheets("Sheet1").ExportAsFixedFormat Type:=xlTypePDF, Filename:=fpath, _
    Quality:=xlQualityStandard, IgnorePrintAreas:=False, OpenAfterPublish:=False
End Sub</code></pre>

<p>上書きを避けたい場合は、Dirで存在チェックをするかタイムスタンプを付与すると運用しやすいです。</p>
</section>

<section id="sec-5">
  <h3>Application.ScreenUpdatingで画面更新を制御する</h3>
  <p>長時間処理では画面更新を止めると高速化できます。必ずエラーハンドラでTrueに戻すことがポイントです。Falseのまま中断すると画面が更新されなくなります。</p>

<pre><code>Sub LongProcess()
  On Error GoTo ErrHandler
  Application.ScreenUpdating = False
  Call CreateSalesChart
  Call ExportSheetToPDF
  MsgBox "完了"
Cleanup:
  Application.ScreenUpdating = True
  Exit Sub
ErrHandler:
  MsgBox "エラー:" &amp; Err.Number &amp; " " &amp; Err.Description
  Resume Cleanup
End Sub</code></pre>

<p>ScreenUpdating以外にもCalculationやEnableEventsを制御すると、さらに高速化できる場合があります。</p>
</section>

<section id="sec-6">
  <h3>注意（ここだけ）</h3>
  <ul>
  <li>Application.ScreenUpdating = False のまま止めず、必ず復帰させます。また、PDF出力で上書きされないようにファイル名を管理します。</li>
</ul>
</section>

      <section id="sec-7">
  <h3>要約</h3>
  <ol>
  <li><p>FormatConditionsで条件付き書式を自動化し、見やすさと一貫性を確保します。</p></li>
  <li><p>ChartObjects.Addでグラフを動的に作成し、シリーズや書式はSeriesCollectionで制御します。</p></li>
  <li><p>PrintOut／PrintPreviewで印刷を自動化し、PageSetupで体裁を固定します。</p></li>
  <li><p>ExportAsFixedFormatでPDF出力を行い、ファイル名に日時を付与したり、存在チェックを行ったりすることを推奨します。</p></li>
  <li><p>Application.ScreenUpdatingをFalseにして高速化し、必ずエラーハンドラでTrueに戻します。</p></li>
</ol>
</section>
    </article>
  </main>
</body>
</html>