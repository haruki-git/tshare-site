ユーザーフォームの基礎（Excel ブイビーエー）。

ユーザーフォームの作成と表示（Show、Hide）。

今回できるようになることとして、簡単な入力フォームを作り、表示・非表示を行ってデータ受け渡しができるようになります。

 新しいフォームはExcelでオルト プラス F11（ブイビーイー）を押して、挿入→UserFormで作成します。

 フォーム表示はUserForm1.Showで行い、HideやUnloadで消すことができます。

 ファイルはマクロ有効形式（.xlsm）で保存する必要があり、開く際にマクロを有効にするとフォームが働きます。

 最小マクロ：以下は標準モジュールに置く最小限の表示マクロです。

（コード例があります）

 貼り付け場所は標準モジュールです。

コントロールの配置（テキストボックス、コマンドボタン、リストボックス、コンボボックス）。

フォームにコントロールを置く際はツールボックスからドラッグします。テキストボックスは文字入力、コマンドボタンは処理起点、リストボックス／コンボボックスは選択肢提示に向きます。

 レイアウトはTabIndexで入力順を整え、Nameプロパティでコード側から参照します。デザイン時にCaptionやBoundColumn（コンボの内部設定）を整えると実行時の混乱を避けられます。保存形式は前節と同じく.xlsmです。

 フォーム側の初期化はInitializeイベントで行うことが多く、選択肢の追加はAddItemメソッドで行います。

（コード例があります）

 実行方法は、ブイビーイーでShowマクロを実行（F5）する方法か、シートにボタンを置いてAssign MacroでShowMyFormを割り当てる方法があります。

イベントプロシージャ（Click、Initialize、Change）。

コントロールはイベントで反応します。Initializeはフォーム表示直前の設定、Clickはボタン押下、Changeはテキストや選択が変わったときに呼ばれます。

 例えばテキストボックスのChangeで入力長を監視し、条件を満たさない場合にラベルで要チェック表示を出す構成が基本です。

 イベント内でErrオブジェクトに頼らない簡潔な分岐を書くと保守が楽になります。

 イベントはフォームモジュール内に自動生成されるため、そのままコードを入れることが通常です。

入力値の検証とエラーメッセージ。

入力値は受け取り側で必ず検証します。数値であればIsNumeric、必須項目はTrimで空白を除去したうえで長さを確認し、日付はIsDateで確かめるのが基本です。

 不正であればMsgBoxで短く理由を伝え、フォーカスを戻すと入力が続けやすくなります。例外処理はErrで捕るより、前提チェックを優先することが読みやすさにつながります。

 よくあるミスとして、テキストの比較でOptionCompareが影響して期待どおりに動かないことがあります。この場合は、比較前にUCaseまたはLCaseで統一すると直しやすいです。

 使い分けの基準として、RangeとCellsは複数セルや名前で指定する場合はRangeを使い、一行ずつループで動かす場合はCellsを使うと可読性が上がります。

 Valueと