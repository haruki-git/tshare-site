繰り返し処理の基本。

For...Next文の基本。

今回できるようになることは、For...Nextで決まった回数だけ繰り返す処理を作れるようになることです。

 For...Nextは「何回繰り返すか」が明確な時に使います。ループ変数を宣言して開始値・終了値を指定すると、処理が自動で繰り返されます。

 最小マクロ：

（コード例があります）

 貼り付け場所は、標準モジュールに貼り付けます。

 実行方法は、ブイビーイー（オルト プラス F11）で開いてF5で実行するか、またはExcelの「マクロ」から実行します。

Stepを使った増減値の指定。

Step句を使うと増分や減分を自由に指定できます。

 Step 2で2ずつ増やしたり、Step ハイフン 1で逆順に減らしたりできます。ループの進み方を変えることで偶数だけ処理するなどの柔軟な制御が可能です。以下は逆順でB列に書く例です。

（コード例があります）

 確認方法：実行後にB列の値が10から1まで逆順で並んでいることを確認します。Stepの符号が想定と逆だと空ループになるので要チェックです。

For Each...Next文でコレクションを処理する。

For Each...Nextは、ワークシートのコレクションやRangeのセル集合など、複数の要素を順に処理するのに向いています。

 インデックスを意識せずに書けるため、コードが読みやすくなります。例えば選択中のセルの色を変える場合は、次のように書きます。

（コード例があります）

 使い分けの基準として、インデックス（1,2,3）の管理が必要な場合はFor...Nextが向きます。一方で、要素ごとに順次処理するだけならFor Each...Nextが簡潔です。

 また、RangeとCellsの違いは参照の仕方にあります。固定範囲を指定するならRange("A1:A10")が適しており、行列番号で参照するならCells(r, c)が向きます。

Do...Loop文の種類と使い分け。

Do...Loopは条件評価の位置を変えることで、「繰り返す前に条件をチェック」するDo While スラッシュ Untilと、「最低1回は実行してから条件をチェック」するLoop While スラッシュ Untilがあります。

 ユーザー入力待ちや、条件が途中で変わる処理には柔軟に対応できます。

 例として、Do While SomeFlag = True ... LoopやDo ... Loop Until IsEmpty(ActiveCell)のように使い分けます。

（コード例があります）

（コード例があります）

 条件をループの先頭で評価すると最小回数が0回になり、ループ末尾で評価すると最低1回は実行される点が違いです。