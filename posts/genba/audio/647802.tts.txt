ネットワークの基本構成が分かる最初の一歩。

ルータ・スイッチ・ファイアウォールの役割。

ルータはネットワーク内と外部をつなぐ機器で、外部と内部を仲介する装置です。この記事ではネットワークの基本構成をやさしく説明し、接続の見方やトラブル時の切り分けができるようになります。

 スイッチは同じネットワーク内で複数の機器をつなぐ機器で、データを適切な相手に渡す装置です。ファイアウォールは通信を許可・拒否するしくみで、ネットワークの門番の役割を担います。これら3つは家庭用とオフィス用で役割が同じで、規模が変わるだけです。

 例え話として、ネットワークを町だと考えると便利です。ルータは町の入り口にある交差点として、外からの郵便や人を振り分けます。スイッチは町内の住所ごとの配達員として、ファイアウォールは入場審査の窓口として考えると分かりやすいです。初心者のうちは「誰がどこへ送るか」をこの比喩でイメージすると理解しやすいです。

IPアドレスとサブネットの基本。

IPアドレスは機器の住所にあたるネットワーク上の識別子です。サブネットは住所のまとまりとして機器を小さなネットワークグループに分ける考え方で、同じサブネット内であれば直接通信しやすいです。DHCPはIPアドレスを自動で配る割り当ての仕組みで、NATは内側と外側のアドレスを変換して共有の外部IPを使えるようにする仕組みです。

 通信できないときの要チェックとして、まず「IPが同じサブネットか」「ゲートウェイ（通常はルータのIP）が正しいか」を確認するのが有効です。ここが整っていれば、物理接続やケーブル、スイッチ側の問題に絞って検証しやすくなります。

 IPとサブネットを確認するときは、最初に「自動取得（DHCP）か固定か」を把握するのが重要です。固定IPを設定する場合は、同じサブネット内でIPが重複しないように基本的なルールを守ることで、通信の混乱を避けやすくなります。

接続確認と切り分けの手順。

接続確認では順序を決めて、確実に潰していくことが効率的です。以下は基本的な切り分け手順です。

 
 
・ 物理層を確認します。電源、ケーブル、リンクランプが正常かを確認します。

 
・ IP設定を確認します。IPアドレス、サブネットマスク、デフォルトゲートウェイを確認します。

 
・ ネットワーク到達性を確認します。まずはローカルの同一サブネット内にpingを打ちます。成功しない場合は、スイッチやNIC（ネットワークカード）に要チェック箇所がある可能性があります。

 
・ 外部への到達を確認します。ゲートウェイへpingが通れば、ルータ以降の問題を切り分けやすくなります。DNS（名前解決）の問題は、IPへ直接アクセスして切り分けます。

 

 上記手順を順に実行すると、「物理」「設定」「名前解決」「経路」のどの層で問題が起きているかを効率よく特定できます。切り分け時は一度に複数の設定を変えないほうがよいです。変更を戻せるようにメモを残しておくと有効です。

よくある失敗例と原因。

よくある失敗例として、固定IPを設定したあとに通信が切れる場合があります。原因は同一サブネット内のIP重複や誤ったサブネットマスク、間違ったデフォルトゲートウェイであることが多いです。解決には他の機器のIP一覧やDHCPサーバの割り当て範囲を確認するとよいです。

 もう一つの失敗例は、ケーブルやポートの物理故障を疑わずに設定を変更し続けることです。物理層の問題は設定変更で改善しないため、最初にケーブルやリンクランプを確認して切り分けると時間を短縮できます。

 避けたい例として、ファイアウォールのルールを雑に追加して外部アクセスが遮断されるケースがあります。ルールの適用順序やログを確認して、どのルールが通信を止めているかを特定するとよいです。ログの見方が分からない場合は、「許可された通信」と「拒否された通信」の例を一つずつ検証する方法が有効です。