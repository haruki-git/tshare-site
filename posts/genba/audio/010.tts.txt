データの抽出と集計（Excel ブイビーエー入門）。

条件に合うデータの抽出方法。

今回できるようになることとして、条件に合う行を抽出して別シートに出力し、次の処理（並べ替え・重複削除・集計）に渡せるようになることです。

 まずはどこにコードを置くか説明します。貼り付け場所は標準モジュール（ブイビーイーで挿入→Module）に入れると再利用がしやすいです。実行方法はオルト プラス F8でマクロ一覧から選ぶか、ボタンに割り当てるか、ブイビーイーでF5実行します。ファイルは必ずマクロ有効形式（.xlsm）で保存してください。

 最小マクロ：以下は表のヘッダーが1行目、データがA:Dにある想定で「状態」列（列C）が「完了」の行だけを抽出して新規シートにコピーする簡単な例です。

（コード例があります）

 確認方法は、抽出先シートにヘッダーと条件に合う行がコピーされていることを確認します。

 よくあるミスとして、ヘッダー行を含めるRange指定を間違えて見出しがコピーされないことが多いので、Row範囲は必ず1行目を含めるよう修正します（End(xlUp)の基準列を確認します）。

AutoFilterメソッドの使い方。

AutoFilter（オートフィルター）はRange.AutoFilterで列を条件指定して表示／非表示を切り替えます。

 複数条件はCriteria1／Operator／Criteria2で扱い、ワイルドカード（*や?）や日付、数値の比較も可能です。

 実行順としてはヘッダー行を含む範囲を対象にAutoFilterを設定し、VisibleなセルだけをSpecialCells(xlCellTypeVisible)で扱います。

 複数列で絞る場合は同じRangeに対して別Fieldを指定して順に適用します。

 抽出後はAutoFilterMode = Falseで元に戻すとユーザー操作の邪魔になりません。

（コード例があります）

Sortメソッドでデータを並べ替える。

Sort（並べ替え）は Range.Sort で複数キーや昇順／降順、ヘッダーの有無を指定できます。

 使い分けの基準として、 Range で範囲を丸ごと指定すると意図が明快で、 Cells を使うと動的に列や行を指定したいときに便利です。

 Value （値）の取得は通常は Value で十分ですが、速度を重視する大量データでは Value2 の方が高速です。

 並べ替えは抽出後に行うことが多く、 SortFields.Add Key:=Range("B2:B1000") のようにキーを追加して Apply すると安定します。

 並べ替えは

注意（ここだけ）。

・破壊的な操作（削除・上書き・権限変更）をする前に、対象と影響範囲を確認し、必要であればバックアップを取ってから進めてください。