Excel ブイビーエーでCSVファイルを扱う基本と実践。

CSVファイルを開く方法（Workbooks.Open、QueryTables）。

目的に応じて使い分けます。単にブックとして開くなら Workbooks.Open／OpenText を使い、取り込み時に区切り文字・列型・文字コードを細かく指定したいなら QueryTables が有利です。例（OpenText の最小例）です。

（コード例があります）

 実行は標準モジュールに貼り付け、ブイビーイー で F5 します。表示が期待通りか A1 などで確認します。

CSVファイルの書き出し（SaveAs xlCSV）。

Workbook.SaveAs で CSV を出力できます。アクティブブックを上書きしたくない場合は、シートをコピーして新規ブックとして保存するのが安全です。Excel のバージョンによっては UTF ハイフン 8 出力向けに xlCSVUTF8 を利用できます。最小例は次のとおりです。

（コード例があります）

 数値や先頭ゼロなどは、セルをテキスト形式にしてから保存すると期待どおりになりやすいです。

文字コードの問題と対処法。

日本語の文字化けは、Origin（読み込み）や BOM（書き出し）の設定で解決することが多いです。

 Origin=932 が Shift_JIS、65001 が UTF ハイフン 8 です。

 SaveAs で UTF ハイフン 8 が使えない場合は、ADODB.Stream や FileSystemObject を使い、バイナリ的に BOM を付けて書き出す方法があります。

 実務では、(1) 取り込み側で Origin を指定して正しく開けるかを確認し、(2) 必要に応じて ADODB.Stream で UTF ハイフン 8（BOM スラッシュ 無BOM）を制御する、という流れが基本です。

テキストファイルの読み書き（Open、Print #、Input #）。

ブイビーエーの古典的手法はOpen／Close／Print #／Line Input #です。行単位の読み書きやヘッダー操作に向きますが、文字コードの制御は弱めです。簡単な書き込み例はこちらです。

（コード例があります）

 読み込みはLine Input #で1行ずつ読み、Debug.Printなどで処理します。UTF ハイフン 8が必要ならADODB.Streamと組み合わせるか、SaveAsを使う方法を選びます。パスやファイルロックは要チェックです。