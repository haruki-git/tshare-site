配列で処理を高速化する：Excel ブイビーエー入門。

1次元配列の宣言と使い方。

今回できるようになることとして、1次元配列を宣言して値の読み書きができるようになります。

 1次元配列は同じ型の値をまとめて扱うため、繰り返し処理で使うとコードがすっきりして速くなります。

 宣言は Dim arr(1 To 5) As Long のように行番号を指定して作り、Forループで値を入れていきます。

 配列は0始まり（Option Base 0）か1始まり（Option Base 1）かが要チェックで、Variant型にするとRangeから直接受け取るときに便利です。

 以下は配列の基本動作を確かめる短いマクロです。

 最小マクロ：

（コード例があります）

 貼り付け場所：標準モジュールに貼り付けます（ブイビーイーで挿入→モジュール）。

 実行方法：ブイビーイーでSubを選んでF5またはExcel上のボタンに割り当てて実行できます。

 確認方法：実行後にワークシートのA1〜A5に10,20,..50が書かれ、MsgBoxで範囲が表示されます。

2次元配列の活用（行と列のデータ管理）。

2次元配列は表形式データ（行×列）をそのまま扱えるため、セルの行列操作で特に有効です。

 宣言は Dim arr(1 To r, 1 To c) As Variant のようにして、 arr(row, col) でアクセスします。

 二重ループで処理するか、Rangeから一括で取得して配列内で処理し、最後に一括で書き戻すと処理時間が大幅に短縮します。

 配列はブイビーエー内部で連続したメモリに格納されるため、セルを1つずつ操作する

注意（ここだけ）。

・破壊的な操作（削除・上書き・権限変更）をする前に、対象と影響範囲を確認して、必要ならバックアップを取ってから進めてください。