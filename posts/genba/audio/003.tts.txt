データ型と変数の使い方。

主要なデータ型（String、Integer、Long、Double、Boolean、Date）。

今回できるようになることとして、データ型の選び方と基本的な変数宣言、型変換の使い分けがわかるようになります。

 Stringは文字列、Integerは小さな整数、Longは大きな整数、Doubleは小数、Booleanは真偽、Dateは日付専用です。Integerは ハイフン 32,768〜32,767なので大きな数はLongを使います。Dateは内部的には数値扱いになるため、日付演算で便利です。型を宣言すると読みやすく、バグを減らせます。

 最小マクロ：

（コード例があります）

 貼り付け場所は、標準モジュール（ブイビーイーの挿入→標準モジュール）に入れます。

 実行方法は、ブイビーイーでマクロを選んでF5実行するか、シートにボタンを置いて割り当てて実行できます。

 確認方法は、MsgBoxで値が表示されるか、シートのセルに書き出して中身を目視で確認します。

変数のスコープ（プロシージャレベル、モジュールレベル、パブリック）。

プロシージャレベルは、SubやFunction内でDimで宣言し、そのプロシージャの中だけで有効な変数です。

 モジュールレベルは、モジュール先頭でPrivateまたはDimを使って宣言し、同じモジュール内の複数プロシージャで共有できます。

 Publicは、標準モジュールの先頭で宣言すると、ワークブック全体で使えます。

 作業する際はブックをマクロ有効形式（.xlsm）で保存し、ファイルを開いたときにマクロを有効にしてください。

 よくあるミスとして、Integerに大きな数を入れてオーバーフローすることがあるため、その場合はLongに変えるか型を確認して直すとよいです。

定数（Const）の活用方法。

Constは変わらない値を名前で管理するために使います。

 税率やバージョン番号、シート名の固定値はConstにしておくと、後から修正が楽になり安全性も上がります。

 モジュール先頭に置くとそのモジュール内で再利用でき、Public Constにすれば他のモジュールでも参照できます。

 コード例として、税率をConstにして計算するスタイルは可読性とメンテナンス性が高くなります。

（コード例があります）

型変換関数（CStr、CInt、CLng、CDbl）の使い分け。

文字列から数値への変換や、浮動小数点から整数への変換は、明示的に型変換すると安全です。CStrは文字列に変換し、CIntは四捨五入してIntegerに変換し、CLngは長整数に変換し、CDblは小数を扱えるDoubleに変換します。

 CIntは扱える範囲が狭く、値が大きいとオーバーフローしやすいので、大きめの整数はCLngを使うのがポイントです。また、数値として解釈できない文字列を変換するとエラーになるため、IsNumericで事前チェックしておくと堅牢になります。

 
 
・整数で扱う範囲が大きい場合はCLngを使います。
 
・端数が必要な場合はCDblを使います。
 
・表示用途ではCStrを使います。
 

 セルから値を取得するときは、Range.ValueとRange.Value2の違いを覚えておくと便利です。日付の正確さが必要ならValueを選び、速度や単純な数値取得を優先するならValue2を選ぶとよいです。