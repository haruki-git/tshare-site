Excel ブイビーエーで学ぶファイル操作の基本。

Workbooks.Openでブックを開く。

今回できるようになることとして、指定したファイルを開いて中のデータを読み取り、閉じる一連の流れが扱えるようになります。

 ブイビーエー（Visual Basic for Applications）はExcel内で動く言語ですので、コードはExcelのブイビーイー（Visual Basic Editor）に貼り付けて実行します。

 ファイルパスは絶対パスが推奨で、ネットワークパスはUNC（\\server\share）の形式を使います。

 マクロ有効化は、ブックを.xlsm形式で保存することと、Excelの「ファイル→オプション→セキュリティセンター」で信頼設定を確認することで先回りできます。

 基本はWorkbooks.Openでブックをオブジェクトとして扱い、変数に入れてから操作します。

 最小マクロ：

（コード例があります）

 貼り付け場所：標準モジュールに貼り付けます（ブイビーイーで「挿入→標準モジュール」）。この場所ならどのシートからも呼び出せます。

Workbooks.Add、Close、Saveの使い方。

Workbooks.Addで新しいブックを作成し、データを書き込んでSaveまたはCloseで保存や破棄を行います。

 新規ブックはオブジェクト変数に格納して操作すると安全です。

 Saveは既に名前が付いているブックを上書き保存し、SaveChanges引数を使うとClose時に保存を制御できます。

 保存形式は拡張子で判断され、マクロ有効なブックは「.xlsm」で保存することが必要です。

 次のコードはワークブックを追加しセルを書き換えて保存する例です。

（コード例があります）

 実行方法は、ブイビーイーの実行ボタン（F5）を使うか、フォームのボタンにこのSubを割り当てて使います。

 頻繁に使うならクイックアクセスツールバーにします。

注意（ここだけ）。

・破壊的な操作（削除・上書き・権限変更）をする前に、対象と影響範囲を確認して、必要ならバックアップを取ってから進めてください。